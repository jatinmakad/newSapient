"use strict";(self.webpackChunksap_data_management_microservice=self.webpackChunksap_data_management_microservice||[]).push([[265],{9265:function(e,n,t){t.r(n),t.d(n,{default:function(){return L}});var a=t(4165),r=t(1413),i=t(5861),s=t(885),c=t(2791),o=t(6871),l=t(6030),u=(t(5975),t(4245)),d=t(4569),p=t.n(d),h=t(4942),f=t(9664),m=t(3382),x=t(8745),g=t(9281),j=t(5855),v=t(703),Z=t(7496),w=t(5574),b=t(7123),y=t(9157),C=t(2993),k=t(768),S=t(184);function U(e){var n=e.setDataRow,t=e.dataRow,d=e.func,x=(0,o.UO)(),j=x.id,w=(x.type,(0,l.v9)((function(e){return e.Login})).isAuth),b=(0,o.s0)(),y=((0,l.I0)(),(0,c.useState)(!1)),U=(0,s.Z)(y,2),R=U[0],N=U[1],D=(0,c.useState)(!1),L=(0,s.Z)(D,2),E=L[0],I=L[1],_=(0,c.useState)(""),H=(0,s.Z)(_,2),A=H[0],J=H[1];(0,c.useEffect)((function(){w||b("/login")}),[w]);var M=(0,c.useState)(),z=(0,s.Z)(M,2),W=z[0],q=z[1],B=function(e,n){var t=e.target.files[0];q((0,r.Z)((0,r.Z)({},W),{},(0,h.Z)({},e.target.name,t))),P(t,n)},P=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(i,s){var c,o,l;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new FileReader;case 2:(c=e.sent).addEventListener("load",(function(){return console.log()})),Object.assign(i,{preview:URL.createObjectURL(i)}),c.readAsDataURL(i),o=i.preview,l=t.map((function(e){return e.id!==s?e:(0,r.Z)((0,r.Z)({},e),{},{image:o,base64EncodedImage:i})})),n(l);case 9:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),T=function(e,n){if(e){var t=new FileReader;t.readAsDataURL(e),t.onloadend=function(){V(t.result,n)}}},V=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(n,t){var r,i,s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=JSON.stringify({data:n,uniqueJobId:j,name:t}),N(!0),i={headers:{"Content-Type":"application/json"}},e.next=5,p().put("https://sap-data-management-mcs.herokuapp.com/upload-documents",r,i);case 5:s=e.sent,!0===s.data.success&&(d(),N(!1),(0,k.Z)("Document Uploaded SuccessFully","success"));case 8:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}();return R?(0,S.jsx)(u.Z,{}):(0,S.jsxs)("div",{className:"m-2 md:m-10 mt-4 p-2 md:p-5 rounded-3xl",children:[(0,S.jsx)(Z.Z,{title:"Upload Document"}),(0,S.jsx)(g.Z,{component:v.Z,children:(0,S.jsx)(f.Z,{"aria-label":"simple table",stickyHeader:!0,children:(0,S.jsx)(m.Z,{children:t?t.map((function(e,n){return(0,S.jsx)(c.Fragment,{children:(0,S.jsx)(F,{row:e,handleFileInputChange:B,handleSubmitFile:T,setEditOpen:I,setEditData:J})}," "+n)})):null})})}),(0,S.jsx)("div",{className:"flex justify-end items-center w-full mt-2",children:(0,S.jsx)(C.Z,{variant:"contained",color:"primary",onClick:function(){return b(-1)},children:"Close"})}),(0,S.jsx)(O,{open:E,setOpen:I,editData:A,func:d,id:j})]})}var F=function(e){var n=e.row,t=e.handleSubmitFile,a=e.handleFileInputChange,r=e.setEditOpen,i=e.setEditData;return console.log(n,"row"),(0,S.jsxs)(j.Z,{children:[(0,S.jsx)(x.Z,{align:"left",children:n.name}),0==n.uploaded?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(x.Z,{component:"th",align:"left",scope:"row",children:(0,S.jsx)(R,{id:n.id,name:n.name,handleFileInputChange:a,previewSource:n.image})}),(0,S.jsx)(x.Z,{align:"left",children:(0,S.jsxs)("button",{className:"bg-gray-300 hover:bg-red-400 hover:text-white text-gray-800 font-normal tracking-wide py-2 px-4 rounded inline-flex items-center",onClick:function(){return t(n.base64EncodedImage,n.name)},type:"submit",children:[(0,S.jsx)("svg",{class:"fill-current w-4 h-4 mr-2 -rotate-180",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,S.jsx)("path",{d:"M13 8V2H7v6H2l8 8 8-8h-5zM0 18h20v2H0v-2z"})}),(0,S.jsx)("span",{children:"Upload"})]})})]}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(x.Z,{children:[(0,S.jsx)("span",{className:"mr-3",children:"Uploaded"}),(0,S.jsx)("a",{href:n.url,target:"_blank",download:!0,children:(0,S.jsx)("span",{className:"text-blue-700 font-medium",children:"Preview"})})]}),(0,S.jsx)(x.Z,{children:(0,S.jsxs)("button",{className:"bg-gray-300 hover:bg-red-400 hover:text-white text-gray-800 font-normal tracking-wide py-2 px-4 rounded inline-flex items-center",onClick:function(){r(!0),i(n)},children:[(0,S.jsx)("svg",{class:"fill-current w-4 h-4 mr-2 -rotate-180",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,S.jsx)("path",{d:"M13 8V2H7v6H2l8 8 8-8h-5zM0 18h20v2H0v-2z"})}),(0,S.jsx)("span",{children:"Edit"})]})})]})]},n.id)},R=function(e){var n=e.id,t=e.name,a=e.handleFileInputChange,r=e.previewSource,i=(0,c.useState)(!1),o=(0,s.Z)(i,2),l=o[0],u=o[1];return(0,S.jsxs)("div",{className:"flex w-full justify-between items-center",children:[(0,S.jsx)("input",{id:n,accept:".png, .jpg, .jpeg, .pdf",type:"file",name:t,onChange:function(e){return a(e,n)},className:"form-input"}),r&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("p",{className:"text-blue-700 cursor-pointer",onClick:function(){u(!0)},children:"Preview"}),(0,S.jsx)(N,{open:l,handleClose:function(){u(!1)},previewSource:r})]})]})},N=function(e){var n=e.open,t=e.handleClose,a=e.previewSource;return(0,S.jsxs)(w.Z,{open:n,onClose:t,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",fullWidth:!0,maxWidth:"lg",children:[(0,S.jsx)(y.Z,{style:{height:"700px"},children:(0,S.jsx)("iframe",{className:"w-full h-full object-cover",src:a})}),(0,S.jsx)(b.Z,{children:(0,S.jsx)(C.Z,{onClick:t,variant:"contained",color:"error",children:"Close"})})]})},O=function(e){var n=e.open,t=e.setOpen,r=e.editData,o=e.func,l=e.id,u=(0,c.useState)(""),d=(0,s.Z)(u,2),h=d[0],f=d[1],m=(0,c.useState)(""),x=(0,s.Z)(m,2),g=x[0],j=x[1],v=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){var n,i,s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=JSON.stringify({data:h,uniqueJobId:l,public_id:r.public_id}),i={headers:{"Content-Type":"application/json"}},e.next=4,p().put("https://sap-data-management-mcs.herokuapp.com/edit-documents",n,i);case 4:s=e.sent,!0===s.data.success&&(o(),t(!1),f(""),j(""),(0,k.Z)("Document Updated SuccessFully","success"));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,S.jsxs)(w.Z,{open:n,onClose:function(){t(!1),f(""),j("")},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",fullWidth:!0,maxWidth:"md",children:[(0,S.jsxs)(y.Z,{sx:{height:"700px"},children:[(0,S.jsx)("input",{type:"file",onChange:function(e){return function(e){if(e){var n=new FileReader;n.readAsDataURL(e),n.onloadend=function(){f(n.result),j(e)}}}(e.target.files[0])},className:"mb-3"}),g&&"image/jpeg"==g.type?(0,S.jsx)("img",{src:URL.createObjectURL(g),width:"500px",height:"100%"}):"application/pdf"==g.type?(0,S.jsx)("iframe",{src:URL.createObjectURL(g),width:"500px",height:"100%"}):""]}),(0,S.jsxs)(b.Z,{children:[h?(0,S.jsx)(C.Z,{onClick:v,variant:"contained",color:"primary",children:"Update"}):"",(0,S.jsx)(C.Z,{onClick:function(){t(!1),f(""),j("")},variant:"contained",color:"error",children:"Close"})]})]})},D=t(5494);function L(){var e=(0,c.useState)(""),n=(0,s.Z)(e,2),t=n[0],d=n[1],h=(0,o.UO)(),f=h.id,m=h.type,x=(0,l.v9)((function(e){return e.Login})).isAuth,g=(0,o.s0)(),j=((0,l.I0)(),(0,c.useState)(!1)),v=(0,s.Z)(j,2),Z=v[0],w=v[1];(0,c.useEffect)((function(){x&&b(),x||g("/login")}),[x,f]);var b=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){var n,t,i,s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w(!0),e.next=3,p().get("https://sap-data-management-mcs.herokuapp.com/get-jobs-by-id?uniqueJobId=".concat(f));case 3:n=e.sent,!0===(t=n.data).success&&(i="Engineering"===m?D.se:"Fire"===m?D.O$:"Marine"===m?D.Y8:"",s=i.map((function(e){var n=t.data[0].documents.find((function(n){return n.name===e.name}));return n?(0,r.Z)((0,r.Z)((0,r.Z)({},e),n),{},{uploaded:!0}):e})),d(s),w(!1));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Z?(0,S.jsx)(u.Z,{}):(0,S.jsx)(U,{setDataRow:d,dataRow:t,func:b})}}}]);
//# sourceMappingURL=265.0140a108.chunk.js.map